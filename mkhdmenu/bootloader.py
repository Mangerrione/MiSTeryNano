BOOTLOADER = [ {
"name":"AHDI", "file": "SHDRIVER.SYS",

"patchdesc": "ACSI #0 only",
"patch": [ (0x28, 0xF0, 0xF0), (0x29, 0xAD, 0xAD),  # check for pattern 
           # test ACSI #0 only
           (0x62, 0x00, 0xFF), (0x63, 0xFF, 0x01), (0x64, 0xFF, 0x00), (0x65, 0x01, 0x00),
           # skip inquiry call as it's very slow
           (0x2c50, 0x61, 0x4e), (0x2c51, 0x00, 0x71), (0x2c52, 0xf2, 0x4e), (0x2c53, 0xd2, 0x71)
          ],  

# hexdump of the AHDI bootloader in the MBR
"mbr":"""
00000000  60 04 60 00 00 b2 08 b8  00 02 04 c5 31 fc 00 00  |`.`.........1...|
00000010  04 46 48 e7 14 00 3f 3c  ff ff 3f 3c 00 0b 4e 4d  |.FH...?<..?<..NM|
00000020  58 4f 08 00 00 03 66 42  70 03 72 f8 41 fa 01 98  |XO....fBp.r.A...|
00000030  0c 83 44 4d 41 72 67 06  78 ff 74 80 60 04 14 05  |..DMArg.x.t.`...|
00000040  67 16 08 10 00 00 67 06  c3 10 b4 10 67 36 d0 fc  |g.....g.....g6..|
00000050  00 0c 51 c8 ff ee 60 12  08 10 00 00 67 04 c3 10  |..Q...`.....g...|
00000060  66 22 d0 fc 00 0c 51 c8  ff f0 50 4f 20 78 04 f2  |f"....Q...PO x..|
00000070  20 28 00 18 48 40 b0 bc  19 87 04 22 64 04 3e 3c  | (..H@....."d.><|
00000080  00 e0 4e 75 2c 28 00 04  7a 01 49 fa 01 74 61 26  |..Nu,(..z.I..ta&|
00000090  4a 40 66 d6 20 4c 32 3c  00 ff 70 00 d0 58 51 c9  |J@f. L2<..p..XQ.|
000000a0  ff fc b0 7c 12 34 66 c2  47 fa 00 0c 4b fa ff be  |...|.4f.G...K...|
000000b0  4c df 00 28 4e d4 4a 44  6b 16 3f 04 2f 0c 3f 05  |L..(N.JDk.?./.?.|
000000c0  2f 06 3f 3c 00 2a 4e 4e  de fc 00 0e 60 00 00 9e  |/.?<.*NN....`...|
000000d0  50 f8 04 3e 20 38 04 ba  54 80 b0 b8 04 ba 64 fa  |P..> 8..T.....d.|
000000e0  3c 7c 86 09 48 e7 02 08  1d 6f 00 07 00 04 1d 6f  |<|..H....o.....o|
000000f0  00 06 00 02 1c af 00 05  4d fa 00 74 1d 6f 00 01  |........M..t.o..|
00000100  00 01 1d 6f 00 02 00 05  1d 6f 00 03 00 09 1d 45  |...o.....o.....E|
00000110  00 0d 50 4f 3c 7c 86 06  3a 7c 86 04 3c bc 01 98  |..PO<|..:|..<...|
00000120  3c bc 00 98 3a 85 3c bc  00 88 70 00 10 07 80 3c  |<...:.<...p....<|
00000130  00 08 48 40 30 3c 00 8a  61 44 41 fa 00 32 74 03  |..H@0<..aDA..2t.|
00000140  20 18 61 3a 51 ca ff fa  2a bc 00 00 00 0a 22 3c  | .a:Q...*....."<|
00000150  00 00 01 90 61 2c 3c bc  00 8a 30 15 c0 7c 00 ff  |....a,<...0..|..|
00000160  67 02 70 ff 3c bc 00 80  51 f8 04 3e 4e 75 00 00  |g.p.<...Q..>Nu..|
00000170  00 8a 00 00 00 8a 00 00  00 8a 00 01 00 8a 2a 80  |..............*.|
00000180  72 0a d2 b8 04 ba 08 38  00 05 fa 01 67 de b2 b8  |r......8....g...|
00000190  04 ba 64 f2 58 4f 60 ca  00 00 00 00 00 00 00 00  |..d.XO`.........|
""",
    
# hexdump of the AHDI bootloader in the partition bootsector
"bootsector":"""
00000000  60 1c 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |`...............|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 76 48  |......A.......vH|
00000020  70 ff 2f 00 3f 03 4e 41  2a 00 2f 40 00 02 3e 83  |p./.?.NA*./@..>.|
00000030  4e 41 5c 4f 4a 80 67 5c  28 40 12 3a ff d0 e0 59  |NA\\OJ.g\\(@.:...Y|
00000040  12 3a ff c9 e0 49 e2 49  74 00 14 3a ff c6 e0 5a  |.:...I.It..:...Z|
00000050  14 3a ff bf 36 3a ff b8  e0 5b c6 c1 d6 86 3c 3a  |.:..6:...[....<:|
00000060  ff b6 e0 5e cc c1 dc 86  dc 83 e8 8a d4 86 22 42  |...^.........."B|
00000070  48 e7 d4 00 7a 01 48 e7  00 44 4e 93 4c df 22 00  |H...z.H..DN.L.".|
00000080  4a 40 67 1e dc 85 bc 89  65 ea 3f 3c 00 49 4e 41  |J@g.....e.?<.INA|
00000090  de fc 00 12 4e d5 53 48  44 52 49 56 45 52 53 59  |....N.SHDRIVERSY|
000000a0  53 00 20 4c 72 0f 70 0a  16 30 00 00 b6 3b 00 e8  |S. Lr.p..0...;..|
000000b0  67 0a d0 fc 00 20 51 c9  ff ee 60 c8 51 c8 ff ea  |g.... Q...`.Q...|
000000c0  2a 28 00 1c e0 5d 48 45  e0 5d 06 85 00 00 08 00  |*(...]HE.]......|
000000d0  ba af 00 0c 62 b4 24 4c  d9 ef 00 0c 98 fc 06 00  |....b.$L........|
000000e0  34 28 00 1a e0 5a 76 ff  7a 00 1a 3a ff 21 ca ef  |4(...Zv.z..:.!..|
000000f0  00 06 3c 02 55 46 cc c5  dc 89 c5 4c 48 e7 20 64  |..<.UF.....LH. d|
00000100  4e 93 4c df 26 04 4a 40  66 80 c5 4c e1 8d da 85  |N.L.&.J@f..L....|
00000110  d5 c5 3c 02 48 c6 e0 8e  dc af 00 08 bc 83 67 14  |..<.H.........g.|
00000120  7a 01 26 06 48 e7 20 64  4e 93 4c df 26 04 4a 40  |z.&.H. dN.L.&.J@|
00000130  66 00 ff 58 02 42 00 ff  d4 42 34 34 20 00 e0 5a  |f..X.B...B44 ..Z|
00000140  6a a6 24 6f 00 00 20 4a  0c 58 60 1a 66 00 ff 3c  |j.$o.. J.X`.f..<|
00000150  43 ea 00 1c d3 d8 d3 d8  d3 e8 00 04 4a 91 67 20  |C...........J.g |
00000160  41 ea 00 1c 22 08 70 00  d1 d9 d3 90 10 19 67 10  |A...".p.......g.|
00000170  b0 3c 00 01 66 06 d0 fc  00 fe 60 f0 d0 c0 60 ea  |.<..f.....`...`.|
00000180  20 2f 00 0c de fc 00 10  4e ea 00 20 00 00 00 00  | /......N.. ....|
"""
},{
"name":"ICD", "file": "ICDBOOT.SYS",

# hexdump of the ICD bootloader in the MBR
"mbr":"""
00000000  2f 0b 2f 3c 00 0b ff ff  4e 4d 58 8f 08 00 00 03  |/./<....NMX.....|
00000010  66 4c 41 fa 01 ae 4a 98  67 44 72 03 02 10 00 81  |fLA...J.gDr.....|
00000020  0c 10 00 81 66 30 49 fa  01 d8 76 01 2c 28 00 04  |....f0I...v.,(..|
00000030  20 06 61 42 66 20 34 3c  00 ff 22 4c 42 40 d0 59  | .aBf 4<.."LB@.Y|
00000040  51 ca ff fc b0 7c 12 34  66 0c 4b fa 00 2a 4e 94  |Q....|.4f.K..*N.|
00000050  1e 3c 00 e0 60 08 d0 fc  00 0c 51 c9 ff c0 30 3c  |.<..`.....Q...0<|
00000060  fd e8 53 40 66 fc 26 5f  4e 75 08 00 00 00 01 00  |..S@f.&_Nu......|
00000070  8a 8a 8a 8a 8a 00 48 e7  7f ff 41 f8 86 04 43 e8  |......H...A...C.|
00000080  00 02 4b f8 fa 01 4d f8  86 09 4a 78 04 3e 66 fa  |..K...M...Jx.>f.|
00000090  50 f8 04 3e 22 38 04 ba  58 81 b2 b8 04 ba 64 fa  |P..>"8..X.....d.|
000000a0  2f 0c 1d 6f 00 03 00 04  1d 6f 00 02 00 02 1c af  |/..o.....o......|
000000b0  00 01 58 8f 45 fa ff b4  24 80 70 08 80 07 14 80  |..X.E...$.p.....|
000000c0  32 bc 01 90 32 bc 00 90  30 83 15 43 00 04 32 bc  |2...2...0..C..2.|
000000d0  00 88 72 05 47 ea 00 06  42 80 10 1a 48 40 10 1b  |..r.G...B...H@..|
000000e0  20 80 4a 41 67 08 61 38  6b 18 51 c9 ff ec 20 3c  | .JAg.a8k.Q... <|
000000f0  00 06 dd d0 61 30 6b 0a  32 bc 00 8a 30 10 c0 7c  |....a0k.2...0..||
00000100  00 ff 32 bc 00 80 4e 71  4a 50 22 3c 00 00 3a 98  |..2...NqJP"<..:.|
00000110  53 81 66 fc 42 78 04 3e  4c df ff fe 4a 40 4e 75  |S.f.Bx.>L...J@Nu|
00000120  20 3c 00 00 3a 98 08 15  00 05 08 15 00 05 08 15  | <..:...........|
00000130  00 05 08 15 00 05 67 04  53 80 6a ea 4e 75 00 00  |......g.S.j.Nu..|
""",

# hexdump of the ICD bootloader in the partition bootsector
"bootsector":"""
00000000  60 2c 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |`,..............|
00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 02  |...%&...........|
00000020  00 00 49 43 44 42 4f 4f  54 20 53 59 53 00 2f 3c  |..ICDBOOT SYS./<|
00000030  00 00 02 00 3f 3c 00 48  4e 41 5c 8f 2c 40 1a 3a  |....?<.HNA\\.,@.:|
00000040  ff cc 48 85 e2 45 34 3a  ff c6 e1 5a 32 3a ff c8  |..H..E4:...Z2:..|
00000050  ee 59 d2 42 42 84 18 3a  ff ba e1 44 18 3a ff b3  |.Y.BB..:...D.:..|
00000060  88 fc 00 10 88 c5 48 44  4a 44 67 00 00 08 d8 bc  |......HDJDg.....|
00000070  00 01 00 00 48 44 d8 41  c4 c5 c2 c5 c8 c5 d4 86  |....HD.A........|
00000080  d2 86 d8 86 76 01 20 01  28 4e 4e 95 66 00 00 34  |....v. .(NN.f..4|
00000090  7c 0f 4a 14 67 00 00 2c  70 0a 41 fa ff 86 16 30  ||.J.g..,p.A....0|
000000a0  00 00 b6 34 00 00 66 0e  51 c8 ff f4 42 80 30 2c  |...4..f.Q...B.0,|
000000b0  00 1a e1 58 66 0e d8 fc  00 20 51 ce ff d6 52 81  |...Xf.... Q...R.|
000000c0  60 c2 70 ff 6b 00 01 08  2c 00 2f 3c ff ff ff ff  |`.p.k...,./<....|
000000d0  3f 3c 00 48 4e 41 5c 8f  02 80 ff ff ff fe 2f 00  |?<.HNA\\......./.|
000000e0  2f 00 3f 3c 00 48 4e 41  5c 8f 28 5f 4a 80 6e 06  |/.?<.HNA\\.(_J.n.|
000000f0  70 ff 60 00 00 54 2f 00  2c 40 d9 c0 42 83 16 3a  |p.`..T/.,@..B..:|
00000100  ff 16 c6 c5 20 03 e1 80  e3 80 99 c0 26 4c 20 02  |.... .......&L .|
00000110  4e 95 66 32 24 05 e3 42  bc 7c ff ff 67 26 42 80  |N.f2$..B.|..g&B.|
00000120  30 06 e3 40 3c 33 08 00  e1 5e 59 40 c0 c5 d0 84  |0..@<3...^Y@....|
00000130  36 02 28 4e 4e 95 66 0e  42 80 30 02 e1 80 e3 80  |6.(NN.f.B.0.....|
00000140  dd c0 60 d4 42 80 26 5f  66 00 00 84 20 4b 0c 58  |..`.B.&_f... K.X|
00000150  60 1a 66 32 43 eb 00 1c  d3 d8 d3 d8 d3 e8 00 04  |`.f2C...........|
00000160  4a 91 67 2e 41 eb 00 1c  42 80 22 08 d1 d9 d3 90  |J.g.A...B.".....|
00000170  10 19 67 1e b0 3c 00 01  66 00 00 08 d0 fc 00 fe  |..g..<..f.......|
00000180  60 ee d1 c0 60 e8 2f 0b  3f 3c 00 49 4e 41 5c 8f  |`...`./.?<.INA\\.|
00000190  70 ff 66 00 00 3a 3c 3a  fe 86 3f 06 3f 3c 00 0e  |p.f..:<:..?.?<..|
000001a0  4e 41 58 8f 9b cd 3b 46  04 46 3b 7a fe 74 04 82  |NAX...;F.F;z.t..|
000001b0  2f 0b 20 3c 57 42 4c 42  4e 93 26 5f 2f 00 2f 0b  |/. <WBLBN.&_/./.|
000001c0  2f 3c 00 4a 00 00 4e 41  df fc 00 00 00 0c 4e 75  |/<.J..NA......Nu|
"""
}

              ]
